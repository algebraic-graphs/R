---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ralget
Ralget creates and combines graphs with algebraic operations. 

```{r example,echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(tidygraph)
library(ggraph)
library(patchwork)
library(magrittr)
devtools::install(); 3
#devtools::install(); 3
library(ralget)
```


### Combining Vertices 

Take the following vertices:
```{r echo=TRUE }
p <- v("p") 
q <- v("q") 
s <- v("s") 
r <- v("r") 
```

The `+` operator places vertices in the same graph.  
The `*` operator joins one vertex to another. 

```{r echo=TRUE, results = "hide" }
g1 <- p * q + s
g2 <- q * s + q* r
g3 <- s * r
```

```{r echo=FALSE, message=FALSE, warning=FALSE, include = TRUE, fig.height=5, fig.width=12.5}
g1 <- p*q+s
g2 <- q*s+q*r
g3 <- s*r
gg <- (g1+g2)

p1 <-
g1 %>% 
    ggraph(data.frame(x = c(1,2,2), y = c(2,2,1)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g1 = p * q + s") + format +
    xlim(c(1,3))



p2 <-
g2 %>% 
    ggraph(data.frame(x = c(2,2,3), y = c(2,1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g2 = q * s + q * r") + format + 
    xlim(c(1,3))

p3 <-
g3 %>% 
    ggraph(data.frame(x = c(2,3), y = c(1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g3 = s * r") + format +
    xlim(c(1,3))


p1 + p2 + p3
```

### Combining graphs  
#### Overlaying graphs ( + )  

The `+` operator overlays graphs.


```{r echo=FALSE, results = "hide" }
gs <- (g1+g2)
```

```{r echo=TRUE, results = "hide" }
g1 + g2
```

```{r echo=FALSE, message=FALSE, warning=FALSE, include = TRUE, fig.height=5, fig.width=12.5}
format <- theme(plot.title = element_text(hjust = 0.5)) +  theme(panel.background = element_rect(fill = rgb(.95,.95,.95,1),color = NA)) 

p1 <-
g1 %>%
    ggraph(data.frame(x = c(1,2,2), y = c(2,2,1)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    # geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g1") + format +
    xlim(c(1,3))



p2 <-
g2 %>%
    ggraph(data.frame(x = c(2,2,3), y = c(2,1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    # geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g2") + format + 
    xlim(c(1,3))


p3 <-
gs %>%
    ggraph(data.frame(x = c(1,2,2,3), y = c(2,2,1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    # geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g1 + g2") + format + 
    xlim(c(1,3))

p1 + p2 + p3

```

#### Connecting graphs ( * )  

The `*` operator creates a link from each vertex in the first graph to each vertex in the second graph. 
```{r echo=FALSE, results = "hide" }
gp <- (g1*g3)
```

```{r echo=TRUE, results = "hide" }
g1 * g3
```
```{r echo=FALSE, message=FALSE, warning=FALSE, include = TRUE, fig.height=5, fig.width=12.5}
format <- theme(plot.title = element_text(hjust = 0.5)) +  theme(panel.background = element_rect(fill = rgb(.95,.95,.95,1),color = NA)) 
p1 <-
g1 %>%
    ggraph(data.frame(x = c(1,2,2), y = c(2,1.9,1)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    # geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g1") + format + xlim(c(1,3))

p2 <-
g3 %>%
    ggraph(data.frame(x = c(2,3), y = c(1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),
      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    # geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g2") + format + xlim(c(1,3))


p3 <-
gp %>%
    ggraph(data.frame(x = c(1,2,2,3), y = c(2,1.90,1,2)))  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("g1 * g2") + format

p1 + p2 + p3

```


#### The Cartesian product ( %x% )  

The `%x%` operator creates the graph product. 

```{r echo=FALSE, results = "hide",  message=FALSE, warning=FALSE}
v0 <- v(name = "00") 
v1 <- v(name = "01") 
v2 <- v(name = "02") 
v3 <- v(name = "03") 

A <- v("A")
B <- v("B")
C <- v("C")
D <- v("D")
E <- v("E")

x = A*B+B*C+C*D+D*E+E*A
y = v0*v1+v1*v2+v2*v3
```

```{r echo=TRUE, results = "hide" }
x %x% y
```

```{r echo=FALSE, message=FALSE, warning=FALSE, include = TRUE, fig.height=6, fig.width=14.5}
layout_df <-data.frame(
  x = c(-2.25625566239723, -2.06694404978908, -1.58402956895644, -1.55953811495272, -1.89737276852298), 
  y = c(0.138709465825545, -1.1508396186631, -0.585121176745636, 0.66449533913645, 1.38325400507676))


p1 <- 
x %>% 
    ggraph(layout_df)  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("x") + format + xlim(c(-4,0))

layout_df <-data.frame(
  x = rev(c(1, 2, 3 ,4)), 
  y = c(0, 0, 0,0)) 

p2 <- 
(y) %>% 
    ggraph(layout_df)  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("y") + format

p3 <-
(x %x% y) %>% 
    ggraph()  +
    geom_edge_link(
      aes(end_cap = circle(10, "pt"),
          start_cap = circle(10, "pt")),

      edge_colour = "black",
      arrow = arrow(
        angle = 15,
        length = unit(0.15, "inches"),
        ends = "last",
        type = "closed"
      )
    ) +
    geom_node_point(col = "grey66", size = 10, show.legend = FALSE) +
    geom_node_text(aes(label = name)) +
    geom_edge_loop(end_cap = circle(10, "pt")) +
    theme_graph() + ggtitle("x %x% y") + format

p1+ p2 + p3
```


### Some more on vertices 
Vertices are created with the `v()` function, which takes a name and list of attributes associated with the vertex. 
This creates a ralget/tidygraph object:
```{r echo=TRUE, message=FALSE, warning=FALSE, include = TRUE}
v("x", Latitude=  78.26077, Longitude=  -94.11077)
```

### Installation
You can install the development version from [GitHub](https://github.com/) with:
``` r
# install.packages("devtools")
devtools::install_github("ianmoran11/ralget")
```

## Algegraic laws

### Addition is commutative
$$ 
V_1 + V_2 = V_2 + V_1 
$$
```{r}
(v1+v2)==(v2+v1)
```

$$ 
V_1 \times V_2 \neq V_2 \times V_1 
$$

```{r}
(v1*v2)==(v2*v1)
```

### Multiplication is distributive
```{r}
(v1*(v2+v3))==((v1*v2)+(v1*v3))
```

$$ 
V_1 \times (V_2 + V_3) = V_1 \times V_2 + V_1 \times V_3
$$ 

```{r}
((v2+v3)*v1)==((v2*v1)+(v3*v1))
```

